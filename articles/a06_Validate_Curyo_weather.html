<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Validate Curyo Wind with Alternate Sources • ChickpeaAscoDispersal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Validate Curyo Wind with Alternate Sources">
<meta property="og:description" content="ChickpeaAscoDispersal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChickpeaAscoDispersal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_Import_raw_data.html">Import Raw Lesion Count Data</a>
    </li>
    <li>
      <a href="../articles/a02_Import_weather_data.html">Weather Data Import and Cleaning</a>
    </li>
    <li>
      <a href="../articles/a03_Visualise_data.html">Visualise Data</a>
    </li>
    <li>
      <a href="../articles/a04_lmer.html">Preliminary lmer models</a>
    </li>
    <li>
      <a href="../articles/a05_GAM.html">Fit Generalised Additive Models (GAMs) to the Dispersal Data</a>
    </li>
    <li>
      <a href="../articles/a06_Validate_Curyo_weather.html">Validate Curyo Wind with Alternate Sources</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a06_Validate_Curyo_weather_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="a06_Validate_Curyo_weather_files/htmlwidgets-1.5.1/htmlwidgets.js"></script><script src="a06_Validate_Curyo_weather_files/jquery-1.12.4/jquery.min.js"></script><link href="a06_Validate_Curyo_weather_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="a06_Validate_Curyo_weather_files/leaflet-1.3.1/leaflet.js"></script><link href="a06_Validate_Curyo_weather_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="a06_Validate_Curyo_weather_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="a06_Validate_Curyo_weather_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="a06_Validate_Curyo_weather_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="a06_Validate_Curyo_weather_files/leaflet-binding-2.0.3/leaflet.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Validate Curyo Wind with Alternate Sources</h1>
                        <h4 class="author">P. Melloy and A.H. Sparks</h4>
            
            <h4 class="date">2020-06-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/blob/master/vignettes/a06_Validate_Curyo_weather.Rmd"><code>vignettes/a06_Validate_Curyo_weather.Rmd</code></a></small>
      <div class="hidden name"><code>a06_Validate_Curyo_weather.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://tidyverse.tidyverse.org">"tidyverse"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://docs.ropensci.org/skimr">"skimr"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://rpkgs.datanovia.com/ggpubr">"ggpubr"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://haozhu233.github.io/kableExtra">"kableExtra"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://scales.r-lib.org">"scales"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://github.com/adamhsparks/ChickpeaAscoDispersal">"ChickpeaAscoDispersal"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://github.com/rich-iannone/stationaRy">"stationaRy"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://docs.ropensci.org/bomrang">"bomrang"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://docs.ropensci.org/clifro">"clifro"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://rstudio.github.io/leaflet">"leaflet"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="https://github.com/rstudio/htmltools">"htmltools"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://lubridate.tidyverse.org">"lubridate"</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st"><a href="http://ggplot2.tidyverse.org">"ggplot2"</a></span>)

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span>(<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/theme_pubr.html">theme_pubclean</a></span>(base_size = <span class="fl">14</span>))

<span class="kw">knitr</span>::<span class="kw"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span>(fig.width = <span class="fl">9.4</span>, fig.height = <span class="fl">9.4</span>)
</pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># run only if knitting on new computer</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># this is necessary to embed fonts in .eps files for EJPP</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">library</span>(<span class="st">"extrafont"</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="cf">if</span> (.Platform<span class="op">$</span>OS.type <span class="op">==</span><span class="st"> "windows"</span>) {</span>
<span id="cb2-6"><a href="#cb2-6"></a>   <span class="kw">font_import</span>(<span class="dt">pattern =</span> <span class="st">"arial"</span>, <span class="dt">prompt =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a>   <span class="kw">loadfonts</span>(<span class="dt">device =</span> <span class="st">"postscript"</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-8"><a href="#cb2-8"></a>} <span class="cf">else</span> {</span>
<span id="cb2-9"><a href="#cb2-9"></a>   <span class="kw">font_import</span>(<span class="dt">pattern =</span> <span class="st">"Arial"</span>, <span class="dt">prompt =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">events</span> <span class="op">&lt;-</span>
   <span class="fu">read_csv</span>(
      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
         <span class="st">"extdata"</span>,
         <span class="st">"Dispersal_experiment_dates.csv"</span>,
         package = <span class="st">"ChickpeaAscoDispersal"</span>,
         mustWork = <span class="fl">TRUE</span>
      )
   ) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(`assessment date` = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">dmy</a></span>(<span class="kw">`assessment date`</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(exposed = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/interval.html">interval</a></span>(<span class="kw">`time out`</span>, <span class="kw">`time removed`</span>))
</pre></div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>During the experimental analysis as the data were being visualised, <a href="see%20data%20visualisation">a03_Visualise_data.html</a>, it became apparent that the Curyo wind data were perhaps incorrect due to the wind vane of the station not being properly calibrated. The on-site weather station recorded the wind direction as coming from the north, blowing towards the south. However, conidia were recorded travelling up to 75 meters from the infested stubble north, against the wind during the spread event. The Dr. Fanning confirmed this weather station did not have the wind vane calibrated recently.</p>
<p>This vignette is aimed at comparing the wind direction and wind speed to nearby weather stations.</p>
</div>
<div id="data-import" class="section level2">
<h2 class="hasAnchor">
<a href="#data-import" class="anchor"></a>Data import</h2>
<p>First we will import the weather data from the Curyo which we suspect to have inaccurate wind direction. The data will be formatted and filtered to only contain weather data during when the trap plants were exposed in the field.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">Curyo_w</span> <span class="op">&lt;-</span>
   <span class="fu">read_csv</span>(
      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
         <span class="st">"extdata"</span>,
         <span class="st">"Curyo_SPA_2019_weather.csv"</span>,
         package = <span class="st">"ChickpeaAscoDispersal"</span>,
         mustWork = <span class="fl">TRUE</span>
      )
   ) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/select.html">select</a></span>(<span class="kw">Time</span>,
          <span class="st">'Wind Speed - average (km/h)'</span>,
          <span class="st">'Wind Direction - average (º)'</span>,
          <span class="st">"Rainfall - (mm)"</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Time = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html">dmy_hm</a></span>(<span class="kw">Time</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Location = <span class="st">"Curyo"</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/select.html">select</a></span>(<span class="kw">Location</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span>()) <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(ws = <span class="kw">`Wind Speed - average (km/h)`</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(wd = <span class="kw">`Wind Direction - average (º)`</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(rainfall = <span class="kw">`Rainfall - (mm)`</span>) <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(ws = <span class="kw">ws</span> <span class="op">/</span> <span class="fl">3.6</span>) <span class="op">%&gt;%</span>  <span class="co"># convert from km/h to m/s</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/filter.html">filter</a></span>(<span class="kw">Time</span> <span class="op">%within%</span> <span class="kw">events</span>[<span class="fl">6</span>, <span class="st">"exposed"</span>])
</pre></div>
<p>Because the data that we download from Bureau of Meteorology (BOM) will be in one hour increments, we will aggregate the 10 minute data to one hourly.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">Curyo_w</span> <span class="op">&lt;-</span>
   <span class="kw">Curyo_w</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Day = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/day.html">day</a></span>(<span class="kw">Time</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Hour = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/hour.html">hour</a></span>(<span class="kw">Time</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="kw">Hour</span>, <span class="kw">Day</span>) <span class="op">%&gt;%</span>
   <span class="fu">summarise</span>(ws = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">ws</span>),
             wd = <span class="fu"><a href="../reference/circular.averaging.html">circular.averaging</a></span>(<span class="kw">wd</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Location = <span class="st">"Curyo"</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/arrange.html">arrange</a></span>(<span class="kw">Day</span>, <span class="kw">Hour</span>) <span class="op">%&gt;%</span>
   <span class="fu">ungroup</span>() <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Time = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(
      from = <span class="kw">events</span>[<span class="kw">events</span><span class="op">$</span><span class="kw">site</span> <span class="op">==</span> <span class="st">"Curyo"</span>, ]<span class="op">$</span><span class="kw">`time out`</span>,
      to = <span class="kw">events</span>[<span class="kw">events</span><span class="op">$</span><span class="kw">site</span> <span class="op">==</span> <span class="st">"Curyo"</span>, ]<span class="op">$</span><span class="kw">`time removed`</span>,
      by = <span class="st">"hour"</span>
   )) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(time = <span class="kw">Time</span>) <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/select.html">select</a></span>(<span class="kw">Location</span>, <span class="kw">time</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span>())
</pre></div>
<p>Next we will import data from a second weather station operated by the Birchip Ag Group approximately 10 kilometres from where our trial took place that Dr. Fanning was able to provide for comparison.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">BCG</span> <span class="op">&lt;-</span>
 <span class="fu">read_csv</span>(
      <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(
         <span class="st">"extdata"</span>,
         <span class="st">"BCG_weather_data.csv"</span>,
         package = <span class="st">"ChickpeaAscoDispersal"</span>,
         mustWork = <span class="fl">TRUE</span>
      ),
   skip = <span class="fl">1</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(time = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd_hms.html">dmy_hm</a></span>(<span class="kw">`Reading Time`</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(`Wind Speed` = <span class="kw">`Wind Speed`</span> <span class="op">/</span> <span class="fl">3.6</span>) <span class="op">%&gt;%</span> <span class="co"># convert from km/h to m/s</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Location = <span class="st">"BCG"</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/select.html">select</a></span>(<span class="kw">Location</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span>()) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(ws = <span class="kw">`Wind Speed`</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(wd = <span class="kw">`Wind Direction`</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(rh = <span class="kw">Humidity</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(temp = <span class="kw">Temperature</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(rainfall = <span class="kw">`Rainfall`</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
      wd = <span class="fu">case_when</span>(
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"N"</span> <span class="op">~</span> <span class="fl">0</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"NNE"</span> <span class="op">~</span> <span class="fl">22.5</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"NE"</span> <span class="op">~</span> <span class="fl">45</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"ENE"</span> <span class="op">~</span> <span class="fl">67.5</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"E"</span> <span class="op">~</span> <span class="fl">90</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"ESE"</span> <span class="op">~</span> <span class="fl">112.5</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"SE"</span> <span class="op">~</span> <span class="fl">135</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"SSE"</span> <span class="op">~</span> <span class="fl">157.5</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"S"</span> <span class="op">~</span> <span class="fl">180</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"SSW"</span> <span class="op">~</span> <span class="fl">202.5</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"SW"</span> <span class="op">~</span> <span class="fl">225</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"WSW"</span> <span class="op">~</span> <span class="fl">247.5</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"W"</span> <span class="op">~</span> <span class="fl">270</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"WNW"</span> <span class="op">~</span> <span class="fl">292.5</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"NW"</span> <span class="op">~</span> <span class="fl">315</span>,
         <span class="kw">wd</span> <span class="op">==</span> <span class="st">"NNW"</span> <span class="op">~</span> <span class="fl">337.5</span>
      )
   ) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/filter.html">filter</a></span>(<span class="kw">time</span> <span class="op">%within%</span> <span class="kw">events</span>[<span class="fl">6</span>, <span class="st">"exposed"</span>])
</pre></div>
<p>The BCG weather station data also need to be aggregated into one hour increments as well.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">Curyo_alt</span> <span class="op">&lt;-</span>
   <span class="kw">BCG</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Day = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/day.html">day</a></span>(<span class="kw">time</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Hour = <span class="fu"><a href="http://lubridate.tidyverse.org/reference/hour.html">hour</a></span>(<span class="kw">time</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="kw">Hour</span>, <span class="kw">Day</span>) <span class="op">%&gt;%</span>
   <span class="fu">summarise</span>(ws = <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="kw">ws</span>),
             wd = <span class="fu"><a href="../reference/circular.averaging.html">circular.averaging</a></span>(<span class="kw">wd</span>)) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Location = <span class="st">"BCG"</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/arrange.html">arrange</a></span>(<span class="kw">Day</span>, <span class="kw">Hour</span>) <span class="op">%&gt;%</span>
   <span class="fu">ungroup</span>() <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(time = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(
      from = <span class="kw">events</span>[<span class="kw">events</span><span class="op">$</span><span class="kw">site</span> <span class="op">==</span> <span class="st">"Curyo"</span>, ]<span class="op">$</span><span class="kw">`time out`</span>,
      to = <span class="kw">events</span>[<span class="kw">events</span><span class="op">$</span><span class="kw">site</span> <span class="op">==</span> <span class="st">"Curyo"</span>, ]<span class="op">$</span><span class="kw">`time removed`</span>,
      by = <span class="st">"hour"</span>
   )[<span class="fl">1</span><span class="op">:</span><span class="fl">58</span>]) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/select.html">select</a></span>(<span class="kw">Location</span>, <span class="kw">time</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span>())


<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span>(<span class="kw">Curyo_alt</span>)
</pre></div>
<table class="table table table-condensed">
<caption>
Data summary
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
Curyo_alt
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
58
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
6
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
POSIXct
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr></tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Hour
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
11.67
</td>
<td style="text-align:right;">
6.48
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
12.00
</td>
<td style="text-align:right;">
16.75
</td>
<td style="text-align:right;">
23.00
</td>
<td style="text-align:left;">
▆▇▇▇▆
</td>
</tr>
<tr>
<td style="text-align:left;">
Day
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
16.03
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
15.00
</td>
<td style="text-align:right;">
15.00
</td>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
17.00
</td>
<td style="text-align:right;">
17.00
</td>
<td style="text-align:left;">
▅▁▇▁▆
</td>
</tr>
<tr>
<td style="text-align:left;">
ws
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.06
</td>
<td style="text-align:right;">
1.02
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:right;">
2.15
</td>
<td style="text-align:right;">
2.80
</td>
<td style="text-align:right;">
4.19
</td>
<td style="text-align:left;">
▃▃▇▅▂
</td>
</tr>
<tr>
<td style="text-align:left;">
wd
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
239.14
</td>
<td style="text-align:right;">
32.83
</td>
<td style="text-align:right;">
180.00
</td>
<td style="text-align:right;">
203.95
</td>
<td style="text-align:right;">
242.35
</td>
<td style="text-align:right;">
270.00
</td>
<td style="text-align:right;">
292.50
</td>
<td style="text-align:left;">
▇▂▇▇▅
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
median
</th>
<th style="text-align:right;">
n_unique
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
time
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2019-10-15 08:00:00
</td>
<td style="text-align:left;">
2019-10-17 17:00:00
</td>
<td style="text-align:left;">
2019-10-16 12:30:00
</td>
<td style="text-align:right;">
58
</td>
</tr></tbody>
</table>
<p>We have data from two weather stations now. However, let’s import data from BOM meteorological stations nearby. We can use the bomrang function <code><a href="https://docs.ropensci.org/bomrang/reference/sweep_for_stations.html">sweep_for_stations()</a></code> to find the closest stations to our experimental site. Because bomrang only obtains historical daily weather information we need to use another package, stationaRy, which can retrieve hourly or 10 minute weather data from the same BOM stations. We then use the station name of the BOM stations in the <code><a href="https://rdrr.io/pkg/stationaRy/man/get_station_metadata.html">get_station_metadata()</a></code> from the <a href="https://cran.r-project.org/package=stationaRy">stationaRy</a> package to obtain weather station IDs. We need the ids to inform the function <code><a href="https://rdrr.io/pkg/stationaRy/man/get_met_data.html">get_met_data()</a></code> from which stations we want weather data.</p>
<p>The <code><a href="https://rdrr.io/pkg/stationaRy/man/get_met_data.html">get_met_data()</a></code> function needs to be run through a loop for each station. We place the weather data from each station into a <code>tibble</code> and store it as an element in a list.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">curyo_latlong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">35.779312</span>, <span class="fl">142.778332</span>)

<span class="kw">stat_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/stationaRy/man/get_station_metadata.html">get_station_metadata</a></span>() <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/filter.html">filter</a></span>(<span class="kw">name</span> <span class="op">%in%</span> <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/sweep_for_stations.html">sweep_for_stations</a></span>(<span class="kw">curyo_latlong</span>)<span class="op">$</span><span class="kw">name</span>[<span class="fl">1</span><span class="op">:</span><span class="fl">4</span>])

<span class="co">for</span> (<span class="kw">i</span> <span class="co">in</span> <span class="kw">stat_dat</span><span class="op">$</span><span class="kw">id</span>) {
   <span class="co">if</span> (<span class="kw">i</span> <span class="op">==</span> <span class="kw">stat_dat</span><span class="op">$</span><span class="kw">id</span>[<span class="fl">1</span>]) {
      <span class="kw">BOM_weather_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
   }
   <span class="fu"><a href="https://docs.ropensci.org/skimr/reference/print.html">print</a></span>(<span class="kw">stat_dat</span><span class="op">$</span><span class="kw">name</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw">stat_dat</span><span class="op">$</span><span class="kw">id</span> <span class="op">==</span> <span class="kw">i</span>)])
   
   <span class="kw">BOM_weather_list</span>[[<span class="kw">i</span>]] <span class="op">&lt;-</span>
      <span class="fu"><a href="https://rdrr.io/pkg/stationaRy/man/get_met_data.html">get_met_data</a></span>(<span class="kw">i</span>, years = <span class="fl">2019</span>) <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/filter.html">filter</a></span>(<span class="kw">time</span> <span class="op">%within%</span> <span class="kw">events</span>[<span class="fl">6</span>, <span class="st">"exposed"</span>]) <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Location = <span class="kw">stat_dat</span><span class="op">$</span><span class="kw">name</span>[<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw">stat_dat</span><span class="op">$</span><span class="kw">id</span> <span class="op">==</span> <span class="kw">i</span>)]) <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/select.html">select</a></span>(<span class="kw">Location</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span>())
}
</pre></div>
<pre><code>## [1] "HOPETOUN AIRPORT"
## [1] "CHARLTON"</code></pre>
<p>Next we bind the data all together in a single tibble called <code>weather_vic</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">weather_vic</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span>(<span class="kw">BOM_weather_list</span>)

<span class="kw">weather_vic</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span>(<span class="kw">weather_vic</span>, <span class="kw">Curyo_w</span>, <span class="kw">Curyo_alt</span>)

<span class="fu"><a href="https://docs.ropensci.org/skimr/reference/skim.html">skim</a></span>(<span class="kw">weather_vic</span>)
</pre></div>
<table class="table table table-condensed">
<caption>
Data summary
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
weather_vic
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
235
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
POSIXct
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Location
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
id
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
temp
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
15.05
</td>
<td style="text-align:right;">
4.26
</td>
<td style="text-align:right;">
6.50
</td>
<td style="text-align:right;">
12.55
</td>
<td style="text-align:right;">
14.75
</td>
<td style="text-align:right;">
17.90
</td>
<td style="text-align:right;">
24.7
</td>
<td style="text-align:left;">
▃▇▇▅▂
</td>
</tr>
<tr>
<td style="text-align:left;">
wd
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
247.52
</td>
<td style="text-align:right;">
92.43
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
210.00
</td>
<td style="text-align:right;">
260.00
</td>
<td style="text-align:right;">
299.84
</td>
<td style="text-align:right;">
360.0
</td>
<td style="text-align:left;">
▂▁▃▇▅
</td>
</tr>
<tr>
<td style="text-align:left;">
ws
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
3.31
</td>
<td style="text-align:right;">
2.23
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
3.03
</td>
<td style="text-align:right;">
4.10
</td>
<td style="text-align:right;">
10.8
</td>
<td style="text-align:left;">
▅▇▂▁▁
</td>
</tr>
<tr>
<td style="text-align:left;">
atmos_pres
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
1012.29
</td>
<td style="text-align:right;">
1.73
</td>
<td style="text-align:right;">
1008.70
</td>
<td style="text-align:right;">
1011.20
</td>
<td style="text-align:right;">
1012.15
</td>
<td style="text-align:right;">
1013.48
</td>
<td style="text-align:right;">
1016.1
</td>
<td style="text-align:left;">
▃▇▇▆▃
</td>
</tr>
<tr>
<td style="text-align:left;">
dew_point
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
7.28
</td>
<td style="text-align:right;">
3.51
</td>
<td style="text-align:right;">
-2.60
</td>
<td style="text-align:right;">
4.80
</td>
<td style="text-align:right;">
7.25
</td>
<td style="text-align:right;">
9.65
</td>
<td style="text-align:right;">
13.5
</td>
<td style="text-align:left;">
▁▅▇▇▆
</td>
</tr>
<tr>
<td style="text-align:left;">
rh
</td>
<td style="text-align:right;">
157
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
64.22
</td>
<td style="text-align:right;">
22.33
</td>
<td style="text-align:right;">
18.00
</td>
<td style="text-align:right;">
46.70
</td>
<td style="text-align:right;">
65.70
</td>
<td style="text-align:right;">
80.27
</td>
<td style="text-align:right;">
100.0
</td>
<td style="text-align:left;">
▃▇▆▇▇
</td>
</tr>
<tr>
<td style="text-align:left;">
ceil_hgt
</td>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
visibility
</td>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Hour
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
11.73
</td>
<td style="text-align:right;">
6.45
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
7.00
</td>
<td style="text-align:right;">
12.00
</td>
<td style="text-align:right;">
17.00
</td>
<td style="text-align:right;">
23.0
</td>
<td style="text-align:left;">
▆▆▆▇▆
</td>
</tr>
<tr>
<td style="text-align:left;">
Day
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
16.04
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
15.00
</td>
<td style="text-align:right;">
15.00
</td>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
17.00
</td>
<td style="text-align:right;">
17.0
</td>
<td style="text-align:left;">
▅▁▇▁▆
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: POSIXct</strong></p>
<table class="table">
<thead><tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:left;">
min
</th>
<th style="text-align:left;">
max
</th>
<th style="text-align:left;">
median
</th>
<th style="text-align:right;">
n_unique
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
time
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
2019-10-15 08:00:00
</td>
<td style="text-align:left;">
2019-10-17 18:00:00
</td>
<td style="text-align:left;">
2019-10-16 13:00:00
</td>
<td style="text-align:right;">
59
</td>
</tr></tbody>
</table>
</div>
<div id="weather-station-locations" class="section level2">
<h2 class="hasAnchor">
<a href="#weather-station-locations" class="anchor"></a>Weather station locations</h2>
<p>Note the coordinates for the BCG data are not included.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="co"># only take rows 1 and 4. Rows 2, 3 have no data and are not represented in wind roses above</span>
<span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/sweep_for_stations.html">sweep_for_stations</a></span>(<span class="kw">curyo_latlong</span>)[<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">4</span>)] <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/select.html">select</a></span>(<span class="kw">name</span>, <span class="kw">lat</span>, <span class="kw">lon</span>) <span class="op">%&gt;%</span>
   <span class="fu">bind_rows</span>(<span class="fu">tibble</span>(name = <span class="st">"CURYO"</span>,
                    lat = <span class="kw">curyo_latlong</span>[<span class="fl">1</span>],
                    lon = <span class="kw">curyo_latlong</span>[<span class="fl">2</span>])) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html">leaflet</a></span>() <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addTiles</a></span>() <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-methods.html">setView</a></span>(lat = <span class="op">-</span><span class="fl">36</span>,
           lng = <span class="fl">142.7</span>,
           zoom = <span class="fl">9</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html">addMarkers</a></span>(lng = <span class="op">~</span> <span class="kw">lon</span>,
              lat = <span class="op">~</span> <span class="kw">lat</span>,
              popup = <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/htmltools/man/htmlEscape.html">htmlEscape</a></span>(<span class="kw">name</span>)) <span class="op">%&gt;%</span> 
   <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addScaleBar.html">addScaleBar</a></span>()
</pre></div>
<div id="htmlwidget-83aaee48eb965bb0d3ed" style="width:902.4px;height:902.4px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-83aaee48eb965bb0d3ed">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[-35.7151,-36.2846,-35.779312],[142.3569,143.3341,142.778332],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["HOPETOUN AIRPORT","CHARLTON","CURYO"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"topright"}]}],"setView":[[-36,142.7],9,[]],"limits":{"lat":[-36.2846,-35.7151],"lng":[142.3569,143.3341]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="wind-roses" class="section level2">
<h2 class="hasAnchor">
<a href="#wind-roses" class="anchor"></a>Wind roses</h2>
<p>We can visualise the wind speed and direction for each site using wind roses.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">pw</span> <span class="op">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(
      <span class="kw">weather_vic</span>,
      <span class="fu"><a href="https://docs.ropensci.org/clifro/reference/windrose.html">windrose</a></span>(
         <span class="kw">ws</span>,
         <span class="kw">wd</span>,
         <span class="kw">Location</span>,
         n_col = <span class="fl">4</span>,
         legend_title = <span class="st">"Wind speed (m/s)"</span>
      )
   )
<span class="kw">pw</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span>(name = <span class="st">"Wind Speed (m/s)"</span>, direction = <span class="op">-</span><span class="fl">1</span>) <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">""</span>) <span class="op">+</span>
   <span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/theme_pubr.html">theme_pubclean</a></span>()
</pre></div>
<div class="figure">
<img src="a06_Validate_Curyo_weather_files/figure-html/wind-rose-1.png" alt="Comparison of wind direction data collected at the Curyo site using the on-site weather station, which was not properly calibrated, and nearby locations, Birchip Group Station’s agriculture farm (BCG) (10 kilometres distant), and Australia BoM weather stations, Hopetoun Airport (39 kilometres) and Charlton (75 kilometres) during the Curyo spread event. BCG’s agriculture farm weather station’s wind direction data were used for the interpretation of conidial dispersal patterns as Curyo’s weather station wind vane was not calibrated." width="902.4"><p class="caption">
Comparison of wind direction data collected at the Curyo site using the on-site weather station, which was not properly calibrated, and nearby locations, Birchip Group Station’s agriculture farm (BCG) (10 kilometres distant), and Australia BoM weather stations, Hopetoun Airport (39 kilometres) and Charlton (75 kilometres) during the Curyo spread event. BCG’s agriculture farm weather station’s wind direction data were used for the interpretation of conidial dispersal patterns as Curyo’s weather station wind vane was not calibrated.
</p>
</div>
<p>From the wind roses, it is apparent that the Curyo weather station is an outlier for direction and possibly wind speed.</p>
</div>
<div id="wind-speed-correlations" class="section level2">
<h2 class="hasAnchor">
<a href="#wind-speed-correlations" class="anchor"></a>Wind Speed Correlations</h2>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">weather_vic</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">time</span>, y = <span class="kw">ws</span>)) <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(shape = <span class="kw">Location</span>,
                  colour = <span class="kw">Location</span>),
              size = <span class="fl">3.5</span>) <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_colour_viridis_d</a></span>()
</pre></div>
<div class="figure">
<img src="a06_Validate_Curyo_weather_files/figure-html/ws-correlations-1.png" alt="Visual inspection of the wind speed data comparing the Curyo site with the Birchip Cropping Group data from 10 kilometres away and two BOM stations 40 to 50 kilometres away." width="902.4"><p class="caption">
Visual inspection of the wind speed data comparing the Curyo site with the Birchip Cropping Group data from 10 kilometres away and two BOM stations 40 to 50 kilometres away.
</p>
</div>
<p>A visual inspection suggests that the wind speed from the Curyo weather station is not suspect and can be used in the model.</p>
</div>
<div id="create-new-figure-3-excluding-the-curyo-data" class="section level2">
<h2 class="hasAnchor">
<a href="#create-new-figure-3-excluding-the-curyo-data" class="anchor"></a>Create New Figure 3 Excluding the Curyo Data</h2>
<p>Because of the incorrect wind direction data from the Curyo station, a new figure needs to be constructed with the BCG data. This will have wind directions that are more in-line with the actual event, but the speeds are not correct for Curyo.</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="co"># The cleaned weather data is autoloaded with the ChickpeaAscoDispersal file</span>
<span class="co"># that was created in "Import weather data".</span>
<span class="co"># Remove Curyo to create a corrected Figure 3, minus Curyo</span>

<span class="kw">cleaned_weather</span> <span class="op">&lt;-</span> 
   <span class="kw">cleaned_weather</span> <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/filter.html">filter</a></span>(<span class="kw">site</span> != <span class="st">"Curyo"</span>) <span class="op">%&gt;%</span>
   <span class="fu">unite</span>(<span class="kw">SpEv</span>, (<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"rep"</span>))) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://docs.ropensci.org/bomrang/reference/rename.html">rename</a></span>(ws = <span class="kw">wind_speed</span>,
          wd = <span class="kw">wind_direction</span>) <span class="op">%&gt;%</span>
   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
      SpEv = <span class="fu">case_when</span>(
         <span class="kw">SpEv</span> <span class="op">==</span> <span class="st">"Horsham irrigated_1"</span> <span class="op">~</span> <span class="st">"Horsham Irrg 1"</span>,
         <span class="kw">SpEv</span> <span class="op">==</span> <span class="st">"Horsham irrigated_2"</span> <span class="op">~</span> <span class="st">"Horsham Irrg 2"</span>,
         <span class="kw">SpEv</span> <span class="op">==</span> <span class="st">"Horsham irrigated_3"</span> <span class="op">~</span> <span class="st">"Horsham Mixd 1"</span>,
         <span class="kw">SpEv</span> <span class="op">==</span> <span class="st">"Horsham dryland_1"</span> <span class="op">~</span> <span class="st">"Horsham Rain 1"</span>,
         <span class="kw">SpEv</span> <span class="op">==</span> <span class="st">"Horsham dryland_2"</span> <span class="op">~</span> <span class="st">"Horsham Rain 2"</span>
      )
   ) <span class="op">%&gt;%</span>
   <span class="fu">mutate_at</span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(<span class="kw">SpEv</span>), <span class="kw">factor</span>)

<span class="co"># create figure 3</span>

<span class="kw">pw</span> <span class="op">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="kw">cleaned_weather</span>,
        <span class="fu"><a href="https://docs.ropensci.org/clifro/reference/windrose.html">windrose</a></span>(<span class="kw">ws</span>,
                 <span class="kw">wd</span>,
                 <span class="kw">SpEv</span>,
                 n_col = <span class="fl">3</span>,
                 legend_title = <span class="st">"Wind speed (m/s)"</span>))
<span class="kw">pw</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_d</a></span>(name = <span class="st">"Wind Speed (m/s)"</span>, direction = <span class="op">-</span><span class="fl">1</span>) <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">""</span>) <span class="op">+</span>
   <span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/theme_pubr.html">theme_pubclean</a></span>()
</pre></div>
<pre><code>## Scale for 'fill' is already present. Adding another scale for 'fill', which
## will replace the existing scale.</code></pre>
<p><img src="a06_Validate_Curyo_weather_files/figure-html/new-fig3-1.png" width="902.4"></p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="co"># save a .png to refer to while writing and a .eps for publication submission</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(<span class="kw">here</span>::<span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man"</span>, <span class="st">"figures/Fig3.png"</span>))
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span>(<span class="kw">here</span>::<span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man"</span>, <span class="st">"figures/Fig3.eps"</span>))
<span class="fu">embed_fonts</span>(
   file = <span class="kw">here</span>::<span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man"</span>,
              <span class="st">"figures/Fig3.eps"</span>),
   outfile = <span class="kw">here</span>::<span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man"</span>,
                        <span class="st">"figures/Fig3.eps"</span>),
   options = <span class="st">"-dEPSCrop"</span>
)
</pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ihsanul Khaliq, Joshua Fanning, Paul Melloy, Jean Galloway, Kevin Moore, Daniel Burrell, Adam H. Sparks, GRDC Project USQ1903-003RTX, Agriculture Victoria and GRDC co-investment project DAV00150, GRDC Project DJP1097-001RTX.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
