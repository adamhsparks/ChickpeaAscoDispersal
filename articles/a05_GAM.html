<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit Generalised Additive Models (GAMs) to the Dispersal Data • ChickpeaAscoDispersal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fit Generalised Additive Models (GAMs) to the Dispersal Data">
<meta property="og:description" content="ChickpeaAscoDispersal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChickpeaAscoDispersal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_Import_raw_data.html">Import Raw Lesion Count Data</a>
    </li>
    <li>
      <a href="../articles/a02_Import_weather_data.html">Weather Data Import and Cleaning</a>
    </li>
    <li>
      <a href="../articles/a03_Visualise_data.html">Visualise Data</a>
    </li>
    <li>
      <a href="../articles/a04_lmer.html">Preliminary lmer models</a>
    </li>
    <li>
      <a href="../articles/a05_GAM.html">Fit Generalised Additive Models (GAMs) to the Dispersal Data</a>
    </li>
    <li>
      <a href="../articles/a06_Validate_Curyo_weather.html">Validate Curyo Wind with Alternate Sources</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fit Generalised Additive Models (GAMs) to the Dispersal Data</h1>
                        <h4 class="author">A.H. Sparks</h4>
            
            <h4 class="date">2020-05-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/blob/master/vignettes/a05_GAM.Rmd"><code>vignettes/a05_GAM.Rmd</code></a></small>
      <div class="hidden name"><code>a05_GAM.Rmd</code></div>

    </div>

    
    
<div id="import-data" class="section level2">
<h2 class="hasAnchor">
<a href="#import-data" class="anchor"></a>Import Data</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ChickpeaAscoDispersal"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"tidyverse"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"broom"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggpubr"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mgcv"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mgcViz"</span>)</pre></body></html></div>
<pre><code>## Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</code></pre>
<pre><code>## Warning: 'rgl.init' failed, running with 'rgl.useNULL = TRUE'.</code></pre>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu">theme_set</span>(<span class="fu"><a href="https://rdrr.io/pkg/ggpubr/man/theme_pubr.html">theme_pubclean</a></span>(<span class="kw">base_size</span> <span class="kw">=</span> <span class="fl">14</span>))</pre></body></html></div>
</div>
<div id="create-data-set-for-gams" class="section level2">
<h2 class="hasAnchor">
<a href="#create-data-set-for-gams" class="anchor"></a>Create Data Set for GAMs</h2>
<p>Join the <code>lesion_counts</code> data and the <code>summary_weather</code> data to create <code>dat</code> for creating GAMs.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">dat</span> <span class="kw">&lt;-</span> <span class="fu">left_join</span>(<span class="no">lesion_counts</span>, <span class="no">summary_weather</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"site"</span>, <span class="st">"rep"</span>))</pre></body></html></div>
</div>
<div id="fit-gams" class="section level2">
<h2 class="hasAnchor">
<a href="#fit-gams" class="anchor"></a>Fit GAMs</h2>
<p>For reproducibility purposes, use <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code>.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">27</span>)</pre></body></html></div>
<div id="mod1---sdistance" class="section level3">
<h3 class="hasAnchor">
<a href="#mod1---sdistance" class="anchor"></a>mod1 - s(Distance)</h3>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">mod1</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod1</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ s(distance, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.08024    0.04751   22.74   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df    F p-value    
## s(distance) 3.926  3.996 78.4  &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.482   Deviance explained = 48.8%
## GCV = 0.76522  Scale est. = 0.75394   n = 334</code></pre>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod1</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance)"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod1-1.png" width="1152"></p>
</div>
<div id="mod2---sdistance-precipitation" class="section level3">
<h3 class="hasAnchor">
<a href="#mod2---sdistance-precipitation" class="anchor"></a>mod2 - s(Distance) + Precipitation</h3>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">mod2</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="no">sum_rain</span>+ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod2</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ sum_rain + s(distance, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.772464   0.092471   8.354 1.89e-15 ***
## sum_rain    0.031885   0.008278   3.852 0.000141 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F p-value    
## s(distance) 3.928  3.996 81.76  &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.502   Deviance explained =   51%
## GCV = 0.7366  Scale est. = 0.72352   n = 334</code></pre>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod2</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + Precipitation"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod2-1.png" width="1152"></p>
</div>
<div id="mod3---sdistance-wind-speed" class="section level3">
<h3 class="hasAnchor">
<a href="#mod3---sdistance-wind-speed" class="anchor"></a>mod3 - s(Distance) + Wind speed</h3>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">mod3</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(<span class="no">m_lesions</span> ~ <span class="no">mws</span> + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
       <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>)

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod3</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ mws + s(distance, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.64401    0.11825   5.446 1.01e-07 ***
## mws          0.12273    0.03059   4.012 7.47e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F p-value    
## s(distance) 3.929  3.996 81.99  &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.504   Deviance explained = 51.2%
## GCV = 0.73389  Scale est. = 0.72086   n = 334</code></pre>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod3</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + Wind speed"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod3-1.png" width="1152"></p>
</div>
<div id="mod4---sdistance-wind-speed-precipitation" class="section level3">
<h3 class="hasAnchor">
<a href="#mod4---sdistance-wind-speed-precipitation" class="anchor"></a>mod4 - s(Distance) + Wind speed + Precipitation</h3>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">mod4</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(<span class="no">m_lesions</span> ~ <span class="no">sum_rain</span> + <span class="no">mws</span> + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
       <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>)

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod4</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ sum_rain + mws + s(distance, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.435675   0.132265   3.294 0.001096 ** 
## sum_rain    0.027392   0.008239   3.325 0.000986 ***
## mws         0.106960   0.030507   3.506 0.000518 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F p-value    
## s(distance) 3.931  3.996 84.56  &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.519   Deviance explained = 52.8%
## GCV = 0.71426  Scale est. = 0.69944   n = 334</code></pre>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod4</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + Wind speed + Precipitation"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod4-1.png" width="1152"></p>
</div>
<div id="mod5---sdistance-wind-speed-precipitation" class="section level3">
<h3 class="hasAnchor">
<a href="#mod5---sdistance-wind-speed-precipitation" class="anchor"></a>mod5 - s(Distance + Wind Speed) + Precipitation</h3>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">mod5</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="no">sum_rain</span> + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span> + <span class="no">mws</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )</pre></body></html></div>
<pre><code>## Warning in term[i] &lt;- attr(terms(reformulate(term[i])), "term.labels"): number
## of items to replace is not a multiple of replacement length</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod5</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ sum_rain + s(distance + mws, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.772464   0.092471   8.354 1.89e-15 ***
## sum_rain    0.031885   0.008278   3.852 0.000141 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F p-value    
## s(distance) 3.928  3.996 81.76  &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.502   Deviance explained =   51%
## GCV = 0.7366  Scale est. = 0.72352   n = 334</code></pre>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod5</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance + Wind Speed) + Precipitation"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod5-1.png" width="1152"></p>
</div>
<div id="mod6---sdistance-swind-speed-precipitation" class="section level3">
<h3 class="hasAnchor">
<a href="#mod6---sdistance-swind-speed-precipitation" class="anchor"></a>mod6 - s(Distance) + s(Wind Speed) + Precipitation</h3>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">mod6</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="no">sum_rain</span> + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">mws</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod6</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ sum_rain + s(distance, k = 5) + s(mws, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.40355    0.18004   7.796 8.82e-14 ***
## sum_rain    -0.03349    0.01810  -1.850   0.0652 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F  p-value    
## s(distance) 3.938  3.997 93.81  &lt; 2e-16 ***
## s(mws)      3.926  3.995 12.66 9.89e-10 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.566   Deviance explained = 57.8%
## GCV = 0.6497  Scale est. = 0.63051   n = 334</code></pre>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod6</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + s(Wind Speed) + Precipitation"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod6-1.png" width="1152"></p>
</div>
<div id="mod7---sdistance-swind-speed" class="section level3">
<h3 class="hasAnchor">
<a href="#mod7---sdistance-swind-speed" class="anchor"></a>mod7 - s(Distance) + s(Wind Speed)</h3>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">mod7</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">mws</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod7</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ s(distance, k = 5) + s(mws, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.08024    0.04366   24.74   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F  p-value    
## s(distance) 3.937  3.997 92.96  &lt; 2e-16 ***
## s(mws)      3.917  3.995 16.04 6.03e-12 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.562   Deviance explained = 57.3%
## GCV = 0.65392  Scale est. = 0.63659   n = 334</code></pre>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod7</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + s(Wind Speed)"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod7-1.png" width="1152"></p>
</div>
<div id="mod8---sdistance-swind-speed-sprecipitation" class="section level3">
<h3 class="hasAnchor">
<a href="#mod8---sdistance-swind-speed-sprecipitation" class="anchor"></a>mod8 - s(Distance) + s(Wind Speed) + s(Precipitation)</h3>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="no">mod8</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">mws</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">sum_rain</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod8</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, 
##     k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.08024    0.04345   24.86   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df      F p-value    
## s(distance) 3.938  3.997 93.805  &lt;2e-16 ***
## s(mws)      1.666  1.761  1.356  0.3332    
## s(sum_rain) 3.192  3.219  3.298  0.0112 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.566   Deviance explained = 57.8%
## GCV = 0.64956  Scale est. = 0.63051   n = 334</code></pre>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod8</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + s(Wind Speed) + s(Precipitation)"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod8-1.png" width="1152"></p>
</div>
<div id="mod9---sdistance-sprecipitation" class="section level3">
<h3 class="hasAnchor">
<a href="#mod9---sdistance-sprecipitation" class="anchor"></a>mod9 - s(Distance) + s(Precipitation)</h3>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">mod9</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">sum_rain</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod9</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ s(distance, k = 5) + s(sum_rain, k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.08024    0.04393   24.59   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F  p-value    
## s(distance) 3.936  3.997 91.78  &lt; 2e-16 ***
## s(sum_rain) 3.901  3.991 15.19 5.39e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.557   Deviance explained = 56.7%
## GCV = 0.66195  Scale est. = 0.64444   n = 334</code></pre>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod9</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + s(Precipitation)"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod9-1.png" width="1152"></p>
</div>
<div id="mod10---sdistance-sprecipitation-wind-speed" class="section level3">
<h3 class="hasAnchor">
<a href="#mod10---sdistance-sprecipitation-wind-speed" class="anchor"></a>mod10 - s(Distance) +s(Precipitation) + Wind speed</h3>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">mod10</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">sum_rain</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) + <span class="no">mws</span>,
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod10</span>)</pre></body></html></div>
<pre><code>## 
## Family: gaussian 
## Link function: identity 
## 
## Formula:
## m_lesions ~ s(distance, k = 5) + s(sum_rain, k = 5) + mws
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -2.5358     1.4136  -1.794   0.0738 .
## mws           1.0174     0.3975   2.559   0.0109 *
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df     F  p-value    
## s(distance) 3.937  3.997 93.76  &lt; 2e-16 ***
## s(sum_rain) 3.764  3.944 13.68 1.49e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.566   Deviance explained = 57.8%
## GCV = 0.64968  Scale est. = 0.63081   n = 334</code></pre>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod10</span>)) +
         <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + s(Precipitation) + Wind speed"</span>),
      <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod10-1.png" width="1152"></p>
</div>
<div id="mod11---sdistance-swind-speed-sprecipitation-family-tw" class="section level3">
<h3 class="hasAnchor">
<a href="#mod11---sdistance-swind-speed-sprecipitation-family-tw" class="anchor"></a>mod11 - s(Distance) + s(Wind Speed) + s(Precipitation), family = tw()</h3>
<p>This is the same as <code>mod8</code> but using <code>family = tw()</code>, see <code><a href="https://rdrr.io/pkg/mgcv/man/family.mgcv.html">?family.mgcv</a></code> for more on the families. The Tweedie distribution is used where the distribution has a positive mass at zero, but is continuous unlike the Poisson distribution that requires count data. The data visualisation shows clearly that the mean pot count data have this shape.</p>
<div class="sourceCode" id="cb39"><html><body><pre class="r"><span class="no">mod11</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) +
         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">mws</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>) +
         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">sum_rain</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>,
      <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/Tweedie.html">tw</a></span>()
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod11</span>)</pre></body></html></div>
<pre><code>## 
## Family: Tweedie(p=1.044) 
## Link function: log 
## 
## Formula:
## m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, 
##     k = 5)
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.22823    0.04098  -5.569 5.39e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##               edf Ref.df       F p-value    
## s(distance) 3.496  3.855 123.776 &lt; 2e-16 ***
## s(mws)      1.992  2.092   0.824 0.45063    
## s(sum_rain) 2.812  2.879   5.493 0.00163 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.674   Deviance explained = 61.2%
## -REML = 309.96  Scale est. = 0.36397   n = 334</code></pre>
<div class="sourceCode" id="cb41"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod11</span>)) +
   <span class="fu">ggtitle</span>(<span class="st">"s(Distance) + s(Wind Speed) + s(Precipitation), family = tw()"</span>),
   <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod11-1.png" width="1152"></p>
</div>
<div id="mod12---sdistance-bs-ts-sprecipitation-bs-ts-wind-speed-family-tw" class="section level3">
<h3 class="hasAnchor">
<a href="#mod12---sdistance-bs-ts-sprecipitation-bs-ts-wind-speed-family-tw" class="anchor"></a>mod12 - s(Distance, bs = “ts”) + s(Precipitation, bs = “ts”) Wind speed, family = tw()</h3>
<p>Try using wind speed as a linear predictor only.</p>
<div class="sourceCode" id="cb42"><html><body><pre class="r"><span class="no">mod12</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">bs</span> <span class="kw">=</span> <span class="st">"ts"</span>) +
         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">mws</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">bs</span> <span class="kw">=</span> <span class="st">"ts"</span>) +
         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">sum_rain</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">bs</span> <span class="kw">=</span> <span class="st">"ts"</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>,
      <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/Tweedie.html">tw</a></span>()
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod12</span>)</pre></body></html></div>
<pre><code>## 
## Family: Tweedie(p=1.044) 
## Link function: log 
## 
## Formula:
## m_lesions ~ s(distance, k = 5, bs = "ts") + s(mws, k = 5, bs = "ts") + 
##     s(sum_rain, k = 5, bs = "ts")
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.22200    0.04089   -5.43 1.11e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##                edf Ref.df       F  p-value    
## s(distance) 3.2481      4 117.664  &lt; 2e-16 ***
## s(mws)      0.9088      4   2.403 0.000269 ***
## s(sum_rain) 2.8645      4  15.752 2.32e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.657   Deviance explained =   60%
## -REML = 319.36  Scale est. = 0.36504   n = 334</code></pre>
<div class="sourceCode" id="cb44"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(
   <span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod12</span>)) +
      <span class="fu">ggtitle</span>(
         <span class="st">"s(Distance, bs = 'ts') + s(Wind speed, bs = 'ts')\n+ s(Precipitation, bs = 'ts'), family = tw()"</span>
      ),
   <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>
)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod12-1.png" width="1152"></p>
</div>
<div id="mod13---sdistance-bs-ts-swind-speed-bs-ts-sprecipitation-bs-ts-family-tw" class="section level3">
<h3 class="hasAnchor">
<a href="#mod13---sdistance-bs-ts-swind-speed-bs-ts-sprecipitation-bs-ts-family-tw" class="anchor"></a>mod13 - s(Distance, bs = “ts”) + s(Wind speed, bs = “ts”) + s(Precipitation, bs = “ts”), family = tw()</h3>
<div class="sourceCode" id="cb45"><html><body><pre class="r"><span class="no">mod13</span> <span class="kw">&lt;-</span>
   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span>(
      <span class="no">m_lesions</span> ~ <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">distance</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">bs</span> <span class="kw">=</span> <span class="st">"ts"</span>) +
         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">mws</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">bs</span> <span class="kw">=</span> <span class="st">"ts"</span>) +
         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span>(<span class="no">sum_rain</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>, <span class="kw">bs</span> <span class="kw">=</span> <span class="st">"ts"</span>),
      <span class="kw">data</span> <span class="kw">=</span> <span class="no">dat</span>,
      <span class="kw">family</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/Tweedie.html">tw</a></span>()
   )

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod13</span>)</pre></body></html></div>
<pre><code>## 
## Family: Tweedie(p=1.044) 
## Link function: log 
## 
## Formula:
## m_lesions ~ s(distance, k = 5, bs = "ts") + s(mws, k = 5, bs = "ts") + 
##     s(sum_rain, k = 5, bs = "ts")
## 
## Parametric coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.22200    0.04089   -5.43 1.11e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Approximate significance of smooth terms:
##                edf Ref.df       F  p-value    
## s(distance) 3.2481      4 117.664  &lt; 2e-16 ***
## s(mws)      0.9088      4   2.403 0.000269 ***
## s(sum_rain) 2.8645      4  15.752 2.32e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## R-sq.(adj) =  0.657   Deviance explained =   60%
## -REML = 319.36  Scale est. = 0.36504   n = 334</code></pre>
<div class="sourceCode" id="cb47"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(
   <span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod13</span>)) +
      <span class="fu">ggtitle</span>(
         <span class="st">"s(Distance, bs = 'ts') + s(Wind speed, bs = 'ts')\n+ s(Precipitation, bs = 'ts'), family = tw()"</span>
      ),
   <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>
)</pre></body></html></div>
<p><img src="a05_GAM_files/figure-html/fit-mod13-1.png" width="1152"></p>
<p>This model, same structure as <code>mod11</code>, uses thin-plate splines to shrink the coefficients of the smooth to zero when possible.</p>
</div>
</div>
<div id="compare-the-models" class="section level2">
<h2 class="hasAnchor">
<a href="#compare-the-models" class="anchor"></a>Compare the Models</h2>
<div id="aic-bic" class="section level3">
<h3 class="hasAnchor">
<a href="#aic-bic" class="anchor"></a>AIC, BIC</h3>
<div class="sourceCode" id="cb48"><html><body><pre class="r"><span class="no">models</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">mod1</span> <span class="kw">=</span> <span class="no">mod1</span>,
               <span class="kw">mod2</span> <span class="kw">=</span> <span class="no">mod2</span>,
               <span class="kw">mod3</span> <span class="kw">=</span> <span class="no">mod3</span>,
               <span class="kw">mod4</span> <span class="kw">=</span> <span class="no">mod4</span>,
               <span class="kw">mod5</span> <span class="kw">=</span> <span class="no">mod5</span>,
               <span class="kw">mod6</span> <span class="kw">=</span> <span class="no">mod6</span>,
               <span class="kw">mod7</span> <span class="kw">=</span> <span class="no">mod7</span>,
               <span class="kw">mod8</span> <span class="kw">=</span> <span class="no">mod8</span>,
               <span class="kw">mod9</span> <span class="kw">=</span> <span class="no">mod9</span>,
               <span class="kw">mod10</span> <span class="kw">=</span> <span class="no">mod10</span>,
               <span class="kw">mod11</span> <span class="kw">=</span> <span class="no">mod11</span>,
               <span class="kw">mod12</span> <span class="kw">=</span> <span class="no">mod12</span>,
               <span class="kw">mod13</span> <span class="kw">=</span> <span class="no">mod13</span>
               )
<span class="fu">map_df</span>(<span class="no">models</span>, <span class="no">glance</span>, <span class="kw">.id</span> <span class="kw">=</span> <span class="st">"model"</span>) <span class="kw">%&gt;%</span>
   <span class="fu">arrange</span>(<span class="no">AIC</span>)</pre></body></html></div>
<pre><code>## # A tibble: 13 x 7
##    model    df logLik   AIC   BIC deviance df.residual
##    &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;dbl&gt;
##  1 mod11  9.30  -320.  663.  709.     141.        325.
##  2 mod12  8.02  -334.  689.  729.     145.        326.
##  3 mod13  8.02  -334.  689.  729.     145.        326.
##  4 mod8   9.80  -392.  805.  847.     204.        324.
##  5 mod10  9.70  -392.  806.  846.     205.        324.
##  6 mod6   9.86  -392.  806.  847.     204.        324.
##  7 mod7   8.85  -394.  808.  845.     207.        325.
##  8 mod9   8.84  -396.  812.  849.     210.        325.
##  9 mod4   6.93  -411.  837.  868.     229.        327.
## 10 mod3   5.93  -416.  846.  873.     236.        328.
## 11 mod2   5.93  -417.  848.  874.     237.        328.
## 12 mod5   5.93  -417.  848.  874.     237.        328.
## 13 mod1   4.93  -424.  860.  883.     248.        329.</code></pre>
</div>
<div id="r2" class="section level3">
<h3 class="hasAnchor">
<a href="#r2" class="anchor"></a>R<sup>2</sup>
</h3>
<div class="sourceCode" id="cb50"><html><body><pre class="r"><span class="fu">enframe</span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
   <span class="kw">mod1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod1</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod2</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod3</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod4</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod4</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod5</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod5</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod6</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod6</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod7</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod7</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod8</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod8</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod9</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod9</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod10</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod10</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod11</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod11</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod12</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod12</span>)$<span class="no">r.sq</span>,
   <span class="kw">mod13</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">mod13</span>)$<span class="no">r.sq</span>
)) <span class="kw">%&gt;%</span>
   <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="no">value</span>))</pre></body></html></div>
<pre><code>## # A tibble: 13 x 2
##    name  value
##    &lt;chr&gt; &lt;dbl&gt;
##  1 mod11 0.674
##  2 mod12 0.657
##  3 mod13 0.657
##  4 mod8  0.566
##  5 mod6  0.566
##  6 mod10 0.566
##  7 mod7  0.562
##  8 mod9  0.557
##  9 mod4  0.519
## 10 mod3  0.504
## 11 mod2  0.502
## 12 mod5  0.502
## 13 mod1  0.482</code></pre>
</div>
<div id="anova" class="section level3">
<h3 class="hasAnchor">
<a href="#anova" class="anchor"></a>ANOVA</h3>
<div class="sourceCode" id="cb52"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span>(<span class="no">mod1</span>,
      <span class="no">mod2</span>,
      <span class="no">mod3</span>,
      <span class="no">mod4</span>,
      <span class="no">mod5</span>,
      <span class="no">mod6</span>,
      <span class="no">mod7</span>,
      <span class="no">mod8</span>,
      <span class="no">mod9</span>,
      <span class="no">mod10</span>,
      <span class="no">mod11</span>,
      <span class="no">mod12</span>,
      <span class="no">mod13</span>,
      <span class="kw">test</span> <span class="kw">=</span> <span class="st">"F"</span>)</pre></body></html></div>
<pre><code>## Analysis of Deviance Table
## 
## Model  1: m_lesions ~ s(distance, k = 5)
## Model  2: m_lesions ~ sum_rain + s(distance, k = 5)
## Model  3: m_lesions ~ mws + s(distance, k = 5)
## Model  4: m_lesions ~ sum_rain + mws + s(distance, k = 5)
## Model  5: m_lesions ~ sum_rain + s(distance + mws, k = 5)
## Model  6: m_lesions ~ sum_rain + s(distance, k = 5) + s(mws, k = 5)
## Model  7: m_lesions ~ s(distance, k = 5) + s(mws, k = 5)
## Model  8: m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, 
##     k = 5)
## Model  9: m_lesions ~ s(distance, k = 5) + s(sum_rain, k = 5)
## Model 10: m_lesions ~ s(distance, k = 5) + s(sum_rain, k = 5) + mws
## Model 11: m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, 
##     k = 5)
## Model 12: m_lesions ~ s(distance, k = 5, bs = "ts") + s(mws, k = 5, bs = "ts") + 
##     s(sum_rain, k = 5, bs = "ts")
## Model 13: m_lesions ~ s(distance, k = 5, bs = "ts") + s(mws, k = 5, bs = "ts") + 
##     s(sum_rain, k = 5, bs = "ts")
##    Resid. Df Resid. Dev          Df Deviance          F    Pr(&gt;F)    
## 1     329.00     248.10                                              
## 2     328.00     237.37  1.00026697    10.73    29.4798 1.108e-07 ***
## 3     328.00     236.49  0.00010208     0.87 23517.8217 8.186e-06 ***
## 4     327.00     228.77  1.00017121     7.73    21.2300 5.859e-06 ***
## 5     328.00     237.37 -1.00027329    -8.60    23.6279 1.821e-06 ***
## 6     324.01     204.37  3.99643310    33.00    22.6848 &lt; 2.2e-16 ***
## 7     325.01     206.98 -1.00079323    -2.61     7.1714 0.0077719 ** 
## 8     324.02     204.41  0.98506967     2.57     7.1679 0.0080600 ** 
## 9     325.01     209.55 -0.98925006    -5.13    14.2593 0.0002005 ***
## 10    324.06     204.57  0.95381798     4.98    14.3389 0.0002324 ***
## 11    323.65     639.85  0.41008504  -435.28                         
## 12    324.67     667.45 -1.02520618   -27.60    73.9641 &lt; 2.2e-16 ***
## 13    324.67     667.45  0.00000000     0.00                         
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="check-best-model-fit" class="section level3">
<h3 class="hasAnchor">
<a href="#check-best-model-fit" class="anchor"></a>Check Best Model Fit</h3>
<div id="mod11---sdistance-swind-speed-sprecipitation-family-tw-1" class="section level4">
<h4 class="hasAnchor">
<a href="#mod11---sdistance-swind-speed-sprecipitation-family-tw-1" class="anchor"></a>mod11 - s(Distance) + s(Wind Speed) + s(Precipitation), family = tw()</h4>
<div class="sourceCode" id="cb54"><html><body><pre class="r"><span class="no">mod11_vis</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod11</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/PkgUtils.html">check</a></span>(<span class="no">mod11_vis</span>,
      <span class="kw">a.qq</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">method</span> <span class="kw">=</span> <span class="st">"tnorm"</span>,
                  <span class="kw">a.cipoly</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="st">"light blue"</span>)),
      <span class="kw">a.respoi</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">0.5</span>),
      <span class="kw">a.hist</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">bins</span> <span class="kw">=</span> <span class="fl">10</span>))</pre></body></html></div>
<pre><code>## 
## Method: REML   Optimizer: outer newton
## full convergence after 8 iterations.
## Gradient range [-4.289034e-07,2.610574e-07]
## (score 309.9554 &amp; scale 0.3639671).
## Hessian positive definite, eigenvalue range [0.3685077,2978.832].
## Model rank =  13 / 13 
## 
## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
## indicate that k is too low, especially if edf is close to k'.
## 
##               k'  edf k-index p-value  
## s(distance) 4.00 3.50    0.87    0.02 *
## s(mws)      4.00 1.99    0.98    0.51  
## s(sum_rain) 4.00 2.81    1.00    0.65  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p><img src="a05_GAM_files/figure-html/mod-check11-1.png" width="1152"></p>
<div class="sourceCode" id="cb56"><html><body><pre class="r"><span class="co"># generate a new plot.gam object just for the publication (no main title)</span>
<span class="no">p11</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/p_gam.html">p_gam</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html">getViz</a></span>(<span class="no">mod11</span>))

<span class="co"># save png and eps files</span>
<span class="fu"><a href="https://rdrr.io/r/grDevices/png.html">png</a></span>(
   <span class="kw">file</span> <span class="kw">=</span> <span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man/figures"</span>, <span class="st">"Fig1.png"</span>),
   <span class="kw">width</span> <span class="kw">=</span> <span class="fl">640</span>,
   <span class="kw">height</span> <span class="kw">=</span> <span class="fl">640</span>,
   <span class="kw">units</span> <span class="kw">=</span> <span class="st">"px"</span>,
   <span class="kw">pointsize</span> <span class="kw">=</span> <span class="fl">14</span>
)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">p11</span>, <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()

<span class="fu"><a href="https://rdrr.io/r/grDevices/postscript.html">postscript</a></span>(<span class="kw">file</span> <span class="kw">=</span> <span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man/figures"</span>, <span class="st">"Fig1.eps"</span>),
           <span class="kw">family</span> <span class="kw">=</span> <span class="st">"Arial"</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span>) + <span class="fl">0.1</span>)
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">p11</span>, <span class="kw">pages</span> <span class="kw">=</span> <span class="fl">1</span>)
<span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span>()

<span class="fu">embed_fonts</span>(
   <span class="kw">file</span> <span class="kw">=</span> <span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man/figures"</span>, <span class="st">"Fig1.eps"</span>),
   <span class="kw">outfile</span> <span class="kw">=</span> <span class="kw pkg">here</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/here/man/here.html">here</a></span>(<span class="st">"man/figures"</span>, <span class="st">"Fig1.eps"</span>),
   <span class="kw">options</span> <span class="kw">=</span> <span class="st">"-dEPSCrop"</span>
)</pre></body></html></div>
</div>
</div>
</div>
<div id="thoughts" class="section level2">
<h2 class="hasAnchor">
<a href="#thoughts" class="anchor"></a>Thoughts</h2>
<p>This model, <em>mod11</em>, <code>m_lesions ~ s(Distance) + s(WindSpeed) + s(Precipitation) - family = tw()</code>, is the best performing model. It cannot be used for predictions, but suitably describes the dispersal data we have on hand with the parameters used. More data would be desirable to increase the value of <code>k</code> as evidenced in the GAM checks.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ihsanul Khaliq, Joshua Fanning, Paul Melloy, Jean Galloway, Kevin Moore, Daniel Burrell, Adam H. Sparks, GRDC Project USQ1903-003RTX, Agriculture Victoria and GRDC co-investment project DAV00150.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
