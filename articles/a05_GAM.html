<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fit Generalised Additive Models (GAMs) to the Dispersal Data • ChickpeaAscoDispersal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Fit Generalised Additive Models (GAMs) to the Dispersal Data">
<meta property="og:description" content="ChickpeaAscoDispersal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChickpeaAscoDispersal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_Import_raw_data.html">Import Raw Lesion Count Data</a>
    </li>
    <li>
      <a href="../articles/a02_Import_weather_data.html">Weather Data Import and Cleaning</a>
    </li>
    <li>
      <a href="../articles/a03_Visualise_data.html">Visualise Data</a>
    </li>
    <li>
      <a href="../articles/a04_lmer.html">Preliminary lmer models</a>
    </li>
    <li>
      <a href="../articles/a05_GAM.html">Fit Generalised Additive Models (GAMs) to the Dispersal Data</a>
    </li>
    <li>
      <a href="../articles/a06_Validate_Curyo_weather.html">Validate Curyo Wind with Alternate Sources</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Fit Generalised Additive Models (GAMs) to the
Dispersal Data</h1>
                        <h4 data-toc-skip class="author">A.H.
Sparks</h4>
            
            <h4 data-toc-skip class="date">2024-05-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/blob/HEAD/vignettes/a05_GAM.Rmd" class="external-link"><code>vignettes/a05_GAM.Rmd</code></a></small>
      <div class="hidden name"><code>a05_GAM.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="import-data">Import Data<a class="anchor" aria-label="anchor" href="#import-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/adamhsparks/ChickpeaAscoDispersal" class="external-link">"ChickpeaAscoDispersal"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://tidyverse.tidyverse.org" class="external-link">"tidyverse"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://broom.tidymodels.org/" class="external-link">"broom"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://rpkgs.datanovia.com/ggpubr/" class="external-link">"ggpubr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/mfasiolo/mgcViz" class="external-link">"mgcViz"</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">theme_pubclean</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-data-set-for-gams">Create Data Set for GAMs<a class="anchor" aria-label="anchor" href="#create-data-set-for-gams"></a>
</h2>
<p>Join the <code>lesion_counts</code> data and the
<code>summary_weather</code> data to create <code>dat</code> for
creating GAMs.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">lesion_counts</span>, <span class="va">summary_weather</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"site"</span>, <span class="st">"rep"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-gams">Fit GAMs<a class="anchor" aria-label="anchor" href="#fit-gams"></a>
</h2>
<p>For reproducibility purposes, use <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="mod1---sdistance">mod1 - s(Distance)<a class="anchor" aria-label="anchor" href="#mod1---sdistance"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod1</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  1.08024    0.04751   22.74   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df    F p-value    </span></span>
<span><span class="co">## s(distance) 3.926  3.996 78.4  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.482   Deviance explained = 48.8%</span></span>
<span><span class="co">## GCV = 0.76522  Scale est. = 0.75394   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance)"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod1-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod2---sdistance-precipitation">mod2 - s(Distance) + Precipitation<a class="anchor" aria-label="anchor" href="#mod2---sdistance-precipitation"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod2</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="va">sum_rain</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ sum_rain + s(distance, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 0.772464   0.092471   8.354 1.89e-15 ***</span></span>
<span><span class="co">## sum_rain    0.031885   0.008278   3.852 0.000141 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.928  3.996 81.76  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.502   Deviance explained =   51%</span></span>
<span><span class="co">## GCV = 0.7366  Scale est. = 0.72352   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + Precipitation"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod2-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod3---sdistance-wind-speed">mod3 - s(Distance) + Wind speed<a class="anchor" aria-label="anchor" href="#mod3---sdistance-wind-speed"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod3</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">m_lesions</span> <span class="op">~</span> <span class="va">mws</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>       data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ mws + s(distance, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  0.64401    0.11825   5.446 1.01e-07 ***</span></span>
<span><span class="co">## mws          0.12273    0.03059   4.012 7.47e-05 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.929  3.996 81.99  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.504   Deviance explained = 51.2%</span></span>
<span><span class="co">## GCV = 0.73389  Scale est. = 0.72086   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + Wind speed"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod3-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod4---sdistance-wind-speed-precipitation">mod4 - s(Distance) + Wind speed + Precipitation<a class="anchor" aria-label="anchor" href="#mod4---sdistance-wind-speed-precipitation"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod4</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span><span class="va">m_lesions</span> <span class="op">~</span> <span class="va">sum_rain</span> <span class="op">+</span> <span class="va">mws</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>       data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ sum_rain + mws + s(distance, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 0.435675   0.132265   3.294 0.001096 ** </span></span>
<span><span class="co">## sum_rain    0.027392   0.008239   3.325 0.000986 ***</span></span>
<span><span class="co">## mws         0.106960   0.030507   3.506 0.000518 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.931  3.996 84.56  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.519   Deviance explained = 52.8%</span></span>
<span><span class="co">## GCV = 0.71426  Scale est. = 0.69944   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + Wind speed + Precipitation"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod4-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod5---sdistance-wind-speed-precipitation">mod5 - s(Distance + Wind Speed) + Precipitation<a class="anchor" aria-label="anchor" href="#mod5---sdistance-wind-speed-precipitation"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod5</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="va">sum_rain</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span> <span class="op">+</span> <span class="va">mws</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in term[i] &lt;- attr(terms(reformulate(term[i])), "term.labels"): number</span></span>
<span><span class="co">## of items to replace is not a multiple of replacement length</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ sum_rain + s(distance + mws, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) 0.772464   0.092471   8.354 1.89e-15 ***</span></span>
<span><span class="co">## sum_rain    0.031885   0.008278   3.852 0.000141 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.928  3.996 81.76  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.502   Deviance explained =   51%</span></span>
<span><span class="co">## GCV = 0.7366  Scale est. = 0.72352   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance + Wind Speed) + Precipitation"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod5-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod6---sdistance-swind-speed-precipitation">mod6 - s(Distance) + s(Wind Speed) + Precipitation<a class="anchor" aria-label="anchor" href="#mod6---sdistance-swind-speed-precipitation"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod6</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="va">sum_rain</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">mws</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ sum_rain + s(distance, k = 5) + s(mws, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  1.40355    0.18004   7.796 8.82e-14 ***</span></span>
<span><span class="co">## sum_rain    -0.03349    0.01810  -1.850   0.0652 .  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.938  3.997 93.81  &lt;2e-16 ***</span></span>
<span><span class="co">## s(mws)      3.926  3.995 12.66  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.566   Deviance explained = 57.8%</span></span>
<span><span class="co">## GCV = 0.6497  Scale est. = 0.63051   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + s(Wind Speed) + Precipitation"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod6-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod7---sdistance-swind-speed">mod7 - s(Distance) + s(Wind Speed)<a class="anchor" aria-label="anchor" href="#mod7---sdistance-swind-speed"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod7</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">mws</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod7</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5) + s(mws, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  1.08024    0.04366   24.74   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.937  3.997 92.96  &lt;2e-16 ***</span></span>
<span><span class="co">## s(mws)      3.917  3.995 16.04  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.562   Deviance explained = 57.3%</span></span>
<span><span class="co">## GCV = 0.65392  Scale est. = 0.63659   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod7</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + s(Wind Speed)"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod7-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod8---sdistance-swind-speed-sprecipitation">mod8 - s(Distance) + s(Wind Speed) + s(Precipitation)<a class="anchor" aria-label="anchor" href="#mod8---sdistance-swind-speed-sprecipitation"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod8</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">mws</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">sum_rain</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod8</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, </span></span>
<span><span class="co">##     k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  1.08024    0.04345   24.86   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df      F p-value    </span></span>
<span><span class="co">## s(distance) 3.938  3.997 93.805  &lt;2e-16 ***</span></span>
<span><span class="co">## s(mws)      1.666  1.761  1.356  0.3404    </span></span>
<span><span class="co">## s(sum_rain) 3.192  3.219  3.298  0.0113 *  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.566   Deviance explained = 57.8%</span></span>
<span><span class="co">## GCV = 0.64956  Scale est. = 0.63051   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + s(Wind Speed) + s(Precipitation)"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod8-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod9---sdistance-sprecipitation">mod9 - s(Distance) + s(Precipitation)<a class="anchor" aria-label="anchor" href="#mod9---sdistance-sprecipitation"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod9</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">sum_rain</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod9</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5) + s(sum_rain, k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)  1.08024    0.04393   24.59   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.936  3.997 91.78  &lt;2e-16 ***</span></span>
<span><span class="co">## s(sum_rain) 3.901  3.991 15.19  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.557   Deviance explained = 56.7%</span></span>
<span><span class="co">## GCV = 0.66195  Scale est. = 0.64444   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + s(Precipitation)"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod9-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod10---sdistance-sprecipitation-wind-speed">mod10 - s(Distance) +s(Precipitation) + Wind speed<a class="anchor" aria-label="anchor" href="#mod10---sdistance-sprecipitation-wind-speed"></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod10</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">sum_rain</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="va">mws</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod10</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: gaussian </span></span>
<span><span class="co">## Link function: identity </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5) + s(sum_rain, k = 5) + mws</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span><span class="co">## (Intercept)  -2.5358     1.4136  -1.794   0.0738 .</span></span>
<span><span class="co">## mws           1.0174     0.3975   2.559   0.0109 *</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df     F p-value    </span></span>
<span><span class="co">## s(distance) 3.937  3.997 93.76  &lt;2e-16 ***</span></span>
<span><span class="co">## s(sum_rain) 3.764  3.944 13.68  &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.566   Deviance explained = 57.8%</span></span>
<span><span class="co">## GCV = 0.64968  Scale est. = 0.63081   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + s(Precipitation) + Wind speed"</span><span class="op">)</span>,</span>
<span>      pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod10-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod11---sdistance-swind-speed-sprecipitation-family-tw">mod11 - s(Distance) + s(Wind Speed) + s(Precipitation), family =
tw()<a class="anchor" aria-label="anchor" href="#mod11---sdistance-swind-speed-sprecipitation-family-tw"></a>
</h3>
<p>This is the same as <code>mod8</code> but using
<code>family = tw()</code>, see <code><a href="https://rdrr.io/pkg/mgcv/man/family.mgcv.html" class="external-link">?family.mgcv</a></code> for more on
the families. The Tweedie distribution is used where the distribution
has a positive mass at zero, but is continuous unlike the Poisson
distribution that requires count data. The data visualisation shows
clearly that the mean pot count data have this shape.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod11</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">mws</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">sum_rain</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/Tweedie.html" class="external-link">tw</a></span><span class="op">(</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: Tweedie(p=1.044) </span></span>
<span><span class="co">## Link function: log </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5) + s(mws, k = 5) + s(sum_rain, </span></span>
<span><span class="co">##     k = 5)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.22823    0.04098  -5.569 5.39e-08 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##               edf Ref.df       F p-value    </span></span>
<span><span class="co">## s(distance) 3.496  3.855 123.776 &lt; 2e-16 ***</span></span>
<span><span class="co">## s(mws)      1.992  2.092   0.824 0.45080    </span></span>
<span><span class="co">## s(sum_rain) 2.812  2.879   5.493 0.00168 ** </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.674   Deviance explained = 61.2%</span></span>
<span><span class="co">## -REML = 309.96  Scale est. = 0.36397   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"s(Distance) + s(Wind Speed) + s(Precipitation), family = tw()"</span><span class="op">)</span>,</span>
<span>   pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod11-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod12---sdistance-bs-ts-sprecipitation-bs-ts-wind-speed-family-tw">mod12 - s(Distance, bs = “ts”) + s(Precipitation, bs = “ts”) Wind
speed, family = tw()<a class="anchor" aria-label="anchor" href="#mod12---sdistance-bs-ts-sprecipitation-bs-ts-wind-speed-family-tw"></a>
</h3>
<p>Try using wind speed as a linear predictor only.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod12</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">mws</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">sum_rain</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/Tweedie.html" class="external-link">tw</a></span><span class="op">(</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod12</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: Tweedie(p=1.044) </span></span>
<span><span class="co">## Link function: log </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5, bs = "ts") + s(mws, k = 5, bs = "ts") + </span></span>
<span><span class="co">##     s(sum_rain, k = 5, bs = "ts")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.22200    0.04089   -5.43 1.11e-07 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##                edf Ref.df       F p-value    </span></span>
<span><span class="co">## s(distance) 3.2481      4 117.664 &lt; 2e-16 ***</span></span>
<span><span class="co">## s(mws)      0.9088      4   2.403 0.00027 ***</span></span>
<span><span class="co">## s(sum_rain) 2.8645      4  15.752 &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.657   Deviance explained =   60%</span></span>
<span><span class="co">## -REML = 319.36  Scale est. = 0.36504   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span></span>
<span>         <span class="st">"s(Distance, bs = 'ts') + s(Wind speed, bs = 'ts')\n+ s(Precipitation, bs = 'ts'), family = tw()"</span></span>
<span>      <span class="op">)</span>,</span>
<span>   pages <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod12-1.png" width="1152"></p>
</div>
<div class="section level3">
<h3 id="mod13---sdistance-bs-ts-swind-speed-bs-ts-sprecipitation-bs-ts-family-tw">mod13 - s(Distance, bs = “ts”) + s(Wind speed, bs = “ts”) +
s(Precipitation, bs = “ts”), family = tw()<a class="anchor" aria-label="anchor" href="#mod13---sdistance-bs-ts-swind-speed-bs-ts-sprecipitation-bs-ts-family-tw"></a>
</h3>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod13</span> <span class="op">&lt;-</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></span><span class="op">(</span></span>
<span>      <span class="va">m_lesions</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">distance</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">mws</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>         <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">sum_rain</span>, k <span class="op">=</span> <span class="fl">5</span>, bs <span class="op">=</span> <span class="st">"ts"</span><span class="op">)</span>,</span>
<span>      data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>      family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/Tweedie.html" class="external-link">tw</a></span><span class="op">(</span><span class="op">)</span></span>
<span>   <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod13</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Family: Tweedie(p=1.044) </span></span>
<span><span class="co">## Link function: log </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Formula:</span></span>
<span><span class="co">## m_lesions ~ s(distance, k = 5, bs = "ts") + s(mws, k = 5, bs = "ts") + </span></span>
<span><span class="co">##     s(sum_rain, k = 5, bs = "ts")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Parametric coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept) -0.22200    0.04089   -5.43 1.11e-07 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Approximate significance of smooth terms:</span></span>
<span><span class="co">##                edf Ref.df       F p-value    </span></span>
<span><span class="co">## s(distance) 3.2481      4 117.664 &lt; 2e-16 ***</span></span>
<span><span class="co">## s(mws)      0.9088      4   2.403 0.00027 ***</span></span>
<span><span class="co">## s(sum_rain) 2.8645      4  15.752 &lt; 2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## R-sq.(adj) =  0.657   Deviance explained =   60%</span></span>
<span><span class="co">## -REML = 319.36  Scale est. = 0.36504   n = 334</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>   <span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod13</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span></span>
<span>         <span class="st">"s(Distance, bs = 'ts') + s(Wind speed, bs = 'ts')\n+ s(Precipitation, bs = 'ts'), family = tw()"</span></span>
<span>      <span class="op">)</span>,</span>
<span>   pages <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="a05_GAM_files/figure-html/fit-mod13-1.png" width="1152"></p>
<p>This model, same structure as <code>mod11</code>, uses thin-plate
splines to shrink the coefficients of the smooth to zero when
possible.</p>
</div>
</div>
<div class="section level2">
<h2 id="compare-the-models">Compare the Models<a class="anchor" aria-label="anchor" href="#compare-the-models"></a>
</h2>
<div class="section level3">
<h3 id="aic-bic">AIC, BIC<a class="anchor" aria-label="anchor" href="#aic-bic"></a>
</h3>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mod1 <span class="op">=</span> <span class="va">mod1</span>,</span>
<span>               mod2 <span class="op">=</span> <span class="va">mod2</span>,</span>
<span>               mod3 <span class="op">=</span> <span class="va">mod3</span>,</span>
<span>               mod4 <span class="op">=</span> <span class="va">mod4</span>,</span>
<span>               mod5 <span class="op">=</span> <span class="va">mod5</span>,</span>
<span>               mod6 <span class="op">=</span> <span class="va">mod6</span>,</span>
<span>               mod7 <span class="op">=</span> <span class="va">mod7</span>,</span>
<span>               mod8 <span class="op">=</span> <span class="va">mod8</span>,</span>
<span>               mod9 <span class="op">=</span> <span class="va">mod9</span>,</span>
<span>               mod10 <span class="op">=</span> <span class="va">mod10</span>,</span>
<span>               mod11 <span class="op">=</span> <span class="va">mod11</span>,</span>
<span>               mod12 <span class="op">=</span> <span class="va">mod12</span>,</span>
<span>               mod13 <span class="op">=</span> <span class="va">mod13</span></span>
<span>               <span class="op">)</span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">glance</span>, .id <span class="op">=</span> <span class="st">"model"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">AIC</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 13 × 8</span></span></span>
<span><span class="co">##    model    df logLik   AIC   BIC deviance df.residual  nobs</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mod11  9.30  -<span style="color: #BB0000;">288.</span>  599.  644.     141.        325.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> mod12  8.02  -<span style="color: #BB0000;">293.</span>  608.  649.     145.        326.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> mod13  8.02  -<span style="color: #BB0000;">293.</span>  608.  649.     145.        326.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> mod8   9.80  -<span style="color: #BB0000;">392.</span>  805.  847.     204.        324.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> mod10  9.70  -<span style="color: #BB0000;">392.</span>  806.  846.     205.        324.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> mod6   9.86  -<span style="color: #BB0000;">392.</span>  806.  847.     204.        324.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> mod7   8.85  -<span style="color: #BB0000;">394.</span>  808.  845.     207.        325.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> mod9   8.84  -<span style="color: #BB0000;">396.</span>  812.  849.     210.        325.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> mod4   6.93  -<span style="color: #BB0000;">411.</span>  837.  868.     229.        327.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> mod3   5.93  -<span style="color: #BB0000;">416.</span>  846.  873.     236.        328.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> mod2   5.93  -<span style="color: #BB0000;">417.</span>  848.  874.     237.        328.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> mod5   5.93  -<span style="color: #BB0000;">417.</span>  848.  874.     237.        328.   334</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> mod1   4.93  -<span style="color: #BB0000;">424.</span>  860.  883.     248.        329.   334</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="r2">R<sup>2</sup><a class="anchor" aria-label="anchor" href="#r2"></a>
</h3>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>   mod1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod6 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod6</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod7</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod8 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod8</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod9 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod9</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod10</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod11 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod12 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod12</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span>,</span>
<span>   mod13 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod13</span><span class="op">)</span><span class="op">$</span><span class="va">r.sq</span></span>
<span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 13 × 2</span></span></span>
<span><span class="co">##    name  value</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> mod11 0.674</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> mod12 0.657</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> mod13 0.657</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> mod8  0.566</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> mod6  0.566</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> mod10 0.566</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> mod7  0.562</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> mod9  0.557</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> mod4  0.519</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> mod3  0.504</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> mod2  0.502</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> mod5  0.502</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span> mod1  0.482</span></span></code></pre>
<blockquote>
<p><strong>NOTE</strong> The original work had an
<code><a href="https://rdrr.io/pkg/mgcv/man/anova.gam.html" class="external-link">anova.gam()</a></code> to compare the models. Somehow, somewhere it
seems that changes have been made and current versions of the R packages
don’t allow an ANOVA comparison for GAMs that use
<code>family = tw()</code>, so this portion has been removed from this
vignette. -ahs 2024-04-28</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="check-best-model-fit">Check Best Model Fit<a class="anchor" aria-label="anchor" href="#check-best-model-fit"></a>
</h3>
<div class="section level4">
<h4 id="mod11---sdistance-swind-speed-sprecipitation-family-tw-1">mod11 - s(Distance) + s(Wind Speed) + s(Precipitation), family =
tw()<a class="anchor" aria-label="anchor" href="#mod11---sdistance-swind-speed-sprecipitation-family-tw-1"></a>
</h4>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod11_vis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/qgam/man/check.html" class="external-link">check</a></span><span class="op">(</span><span class="va">mod11_vis</span>,</span>
<span>      a.qq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"tnorm"</span>, </span>
<span>                  a.cipoly <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"light blue"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>      a.respoi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>      a.hist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Method: REML   Optimizer: outer newton</span></span>
<span><span class="co">## full convergence after 8 iterations.</span></span>
<span><span class="co">## Gradient range [-4.288874e-07,2.610557e-07]</span></span>
<span><span class="co">## (score 309.9554 &amp; scale 0.3639671).</span></span>
<span><span class="co">## Hessian positive definite, eigenvalue range [0.3685077,2978.832].</span></span>
<span><span class="co">## Model rank =  13 / 13 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Basis dimension (k) checking results. Low p-value (k-index&lt;1) may</span></span>
<span><span class="co">## indicate that k is too low, especially if edf is close to k'.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##               k'  edf k-index p-value  </span></span>
<span><span class="co">## s(distance) 4.00 3.50    0.87    0.02 *</span></span>
<span><span class="co">## s(mws)      4.00 1.99    0.98    0.51  </span></span>
<span><span class="co">## s(sum_rain) 4.00 2.81    1.00    0.65  </span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p><img src="a05_GAM_files/figure-html/mod-check11-1.png" width="1152"></p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a new plot.gam object just for the publication (no main title)</span></span>
<span><span class="va">p11</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/p_gam.html">p_gam</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcViz/man/getViz.html" class="external-link">getViz</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># save png and eps files</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span></span>
<span>   file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"man/figures"</span>, <span class="st">"Fig1.png"</span><span class="op">)</span>,</span>
<span>   width <span class="op">=</span> <span class="fl">640</span>,</span>
<span>   height <span class="op">=</span> <span class="fl">640</span>,</span>
<span>   units <span class="op">=</span> <span class="st">"px"</span>,</span>
<span>   pointsize <span class="op">=</span> <span class="fl">14</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p11</span>, pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/postscript.html" class="external-link">postscript</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"man/figures"</span>, <span class="st">"Fig1.eps"</span><span class="op">)</span>,</span>
<span>           family <span class="op">=</span> <span class="st">"Arial"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p11</span>, pages <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">embed_fonts</span><span class="op">(</span></span>
<span>   file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"man/figures"</span>, <span class="st">"Fig1.eps"</span><span class="op">)</span>,</span>
<span>   outfile <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"man/figures"</span>, <span class="st">"Fig1.eps"</span><span class="op">)</span>,</span>
<span>   options <span class="op">=</span> <span class="st">"-dEPSCrop"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="thoughts">Thoughts<a class="anchor" aria-label="anchor" href="#thoughts"></a>
</h2>
<p>This model, <em>mod11</em>,
<code>m_lesions ~ s(Distance) + s(WindSpeed) + s(Precipitation) - family = tw()</code>,
is the best performing model. It cannot be used for predictions, but
suitably describes the dispersal data we have on hand with the
parameters used. More data would be desirable to increase the value of
<code>k</code> as evidenced in the GAM checks.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Ihsanul Khaliq, Joshua Fanning, Paul Melloy, Jean Galloway, Kevin Moore, Daniel Burrell, Adam H. Sparks, GRDC Project USQ1903-003RTX, Agriculture Victoria and GRDC co-investment project DAV00150, GRDC Project DJP1097-001RTX.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
