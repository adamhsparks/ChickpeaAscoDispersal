<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preliminary lmer models • ChickpeaAscoDispersal</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Preliminary lmer models">
<meta property="og:description" content="ChickpeaAscoDispersal">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ChickpeaAscoDispersal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a01_Import_raw_data.html">Import Raw Lesion Count Data</a>
    </li>
    <li>
      <a href="../articles/a02_Import_weather_data.html">Weather Data Import and Cleaning</a>
    </li>
    <li>
      <a href="../articles/a03_Visualise_data.html">Visualise Data</a>
    </li>
    <li>
      <a href="../articles/a04_lmer.html">Preliminary lmer models</a>
    </li>
    <li>
      <a href="../articles/a05_GAM.html">Fit Generalised Additive Models (GAMs) to the Dispersal Data</a>
    </li>
    <li>
      <a href="../articles/a06_Validate_Curyo_weather.html">Validate Curyo Wind with Alternate Sources</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a04_lmer_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Preliminary lmer models</h1>
                        <h4 class="author">P. Melloy</h4>
            
            <h4 class="date">2021-01-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/adamhsparks/ChickpeaAscoDispersal/blob/master/vignettes/a04_lmer.Rmd"><code>vignettes/a04_lmer.Rmd</code></a></small>
      <div class="hidden name"><code>a04_lmer.Rmd</code></div>

    </div>

    
    
<div id="aims" class="section level2">
<h2 class="hasAnchor">
<a href="#aims" class="anchor"></a>Aims</h2>
<p>This vignette demonstrates and explains our reasoning during preliminary data analysis method. The aims of this document were to explore the role of ‘site’ on conidial dispersal.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/adamhsparks/ChickpeaAscoDispersal">"ChickpeaAscoDispersal"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://tidyverse.tidyverse.org">"tidyverse"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lme4/lme4/">"lme4"</a></span><span class="op">)</span></code></pre></div>
<p>From this data we hope to interpret the following.</p>
<ul>
<li>Did experimental location (site) affect conidial dispersal.</li>
</ul>
<p>In this experiment there are a number of factors which may influence conidia spread. These include:</p>
<ul>
<li><p>Experimental location (site).</p></li>
<li>
<p>The time at which a spread event occurred (SpEv).</p>
<ul>
<li><p>The factor SpEv would be nested within site.</p></li>
<li><p>SpEv factor may describe variation in the data that varies between SpEv, such as weather and climate variables.</p></li>
</ul>
</li>
<li><p>Wind speed during the spread event.</p></li>
<li><p>Wind direction during the spread event.</p></li>
<li><p>Distance the trap plants were placed from the aschochyta infested plots (distance).</p></li>
<li><p>The bearing in which the trap plants were placed at distances relative to the infested plots (transect).</p></li>
<li><p>How the spread event was initiated, with sprinkler irrigation or rainfall.</p></li>
<li><p>The quantity of rainfall.</p></li>
</ul>
<p>Due to the lack of replicated pots at some of the distances we will ignore transect as a factor. We know wind direction will influence our results and we will need to accept that adds variation for which we may not be able to account for statistically.</p>
<p>I will start using <code><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer()</a></code> to analyse the mean number of lesions per plant at each distance. The reps at each distance are defined by ‘pot’, each pot contains three to five chickpea plants. The factor distance is fit as a continuous variable.</p>
<p>Site is a categorical variable explaining the trial location. Each site may have experienced a different number of spread events, defined by the term <code>SpEv</code>. Rainfall is required for conidia to disperse from the infected focus, and each ‘spread event’ constitutes either an overhead irrigation event or a natural rainfall event.</p>
<p>The first models I will look at are asking:</p>
<ol style="list-style-type: lower-roman">
<li>What is the estimated mean lesions per plant as each distance from the focus, given that the conditions of each spread event is nested within each site and the distance the spore travels is dependent on the spread event at each site.</li>
<li>What is the estimated mean lesions per plant as each distance from the focus, given that distance is dependant on the conditions of each spread event.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat</span> <span class="op">&lt;-</span>
  <span class="fu">left_join</span><span class="op">(</span><span class="va">lesion_counts</span>, <span class="va">summary_weather</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"site"</span>, <span class="st">"rep"</span><span class="op">)</span><span class="op">)</span>

<span class="va">mod1</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">m_lesions</span> <span class="op">~</span> <span class="va">distance</span> <span class="op">+</span> <span class="op">(</span><span class="va">distance</span> <span class="op">|</span> <span class="va">site</span> <span class="op">/</span> <span class="va">SpEv</span><span class="op">)</span>,
       data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"mod1: "</span><span class="op">)</span></code></pre></div>
<pre><code>## mod1:</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></code></pre></div>
<pre><code>## m_lesions ~ distance + (distance | site/SpEv)</code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML ['lmerMod']
## Formula: m_lesions ~ distance + (distance | site/SpEv)
##    Data: dat
## 
## REML criterion at convergence: 911.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3523 -0.6015 -0.0971  0.4908  5.8015 
## 
## Random effects:
##  Groups    Name        Variance  Std.Dev. Corr 
##  SpEv:site (Intercept) 0.5350421 0.73147       
##            distance    0.0001785 0.01336  -1.00
##  site      (Intercept) 0.2071781 0.45517       
##            distance    0.7845495 0.88575  0.09 
##  Residual              0.7695721 0.87725       
## Number of obs: 334, groups:  SpEv:site, 6; site, 3
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  1.88614    0.41445   4.551
## distance    -0.02603    0.51142  -0.051
## 
## Correlation of Fixed Effects:
##          (Intr)
## distance 0.045 
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see ?isSingular</code></pre>
<p>Let’s examine the model without ‘site’ to test if the model is a worse fit.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod2</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">m_lesions</span> <span class="op">~</span> <span class="va">distance</span> <span class="op">+</span>
         <span class="op">(</span><span class="va">distance</span> <span class="op">|</span> <span class="va">SpEv</span><span class="op">)</span>,
       data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></code></pre></div>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"mod2: "</span><span class="op">)</span></code></pre></div>
<pre><code>## mod2:</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></code></pre></div>
<pre><code>## m_lesions ~ distance + (distance | SpEv)</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compare models</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod1</span>, <span class="va">mod2</span><span class="op">)</span></code></pre></div>
<pre><code>## refitting model(s) with ML (instead of REML)</code></pre>
<pre><code>## Data: dat
## Models:
## mod2: m_lesions ~ distance + (distance | SpEv)
## mod1: m_lesions ~ distance + (distance | site/SpEv)
##      npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
## mod2    6 889.71 912.58 -438.85   877.71                     
## mod1    9 895.45 929.75 -438.72   877.45 0.2606  3     0.9673</code></pre>
<p>A comparison of the two models shows us that <code>mod2</code> is much better fit given the lower AIC and that there is no significant difference in the models. Following a reductive approach we should remove site from the model.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML ['lmerMod']
## Formula: m_lesions ~ distance + (distance | SpEv)
##    Data: dat
## 
## REML criterion at convergence: 889.9
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3652 -0.5628 -0.1261  0.4583  5.7863 
## 
## Random effects:
##  Groups   Name        Variance  Std.Dev. Corr 
##  SpEv     (Intercept) 0.9534636 0.97645       
##           distance    0.0002697 0.01642  -1.00
##  Residual             0.7698005 0.87738       
## Number of obs: 334, groups:  SpEv, 6
## 
## Fixed effects:
##              Estimate Std. Error t value
## (Intercept)  1.963345   0.406414   4.831
## distance    -0.027052   0.006974  -3.879
## 
## Correlation of Fixed Effects:
##          (Intr)
## distance -0.986
## optimizer (nloptwrap) convergence code: 0 (OK)
## boundary (singular) fit: see ?isSingular</code></pre>
<p>We can also note that as the distance increases there are less mean lesions per pot, and the variance increases.</p>
<p>From here we should continue with a generalised additive model (GAM), which can handle non-linear terms better than a linear model.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ihsanul Khaliq, Joshua Fanning, Paul Melloy, Jean Galloway, Kevin Moore, Daniel Burrell, Adam H. Sparks, GRDC Project USQ1903-003RTX, Agriculture Victoria and GRDC co-investment project DAV00150, GRDC Project DJP1097-001RTX.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
